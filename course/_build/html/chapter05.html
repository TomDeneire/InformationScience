

<!DOCTYPE html>

<html>
  <head>
    <meta charset="utf-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
    <title>Chapter 5: Querying Information &#8212; Information Science</title>
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.11.2/css/all.min.css" integrity="sha384-KA6wR/X5RY4zFAHpv/CnoG2UW1uogYfdnP67Uv7eULvTveboZJg0qUpmJZb5VqzN" crossorigin="anonymous">
    <link href="_static/css/index.css" rel="stylesheet">
    <link rel="stylesheet" href="_static/sphinx-book-theme.css" type="text/css" />
    <link rel="stylesheet" href="_static/pygments.css" type="text/css" />
    <link rel="stylesheet" type="text/css" href="_static/togglebutton.css" />
    <link rel="stylesheet" type="text/css" href="_static/copybutton.css" />
    <link rel="stylesheet" type="text/css" href="_static/mystnb.css" />
    <link rel="stylesheet" type="text/css" href="_static/sphinx-thebe.css" />
    <link rel="stylesheet" type="text/css" href="_static/sphinx-dropdown.css" />
    <script id="documentation_options" data-url_root="./" src="_static/documentation_options.js"></script>
    <script src="_static/jquery.js"></script>
    <script src="_static/underscore.js"></script>
    <script src="_static/doctools.js"></script>
    <script src="_static/language_data.js"></script>
    <script src="_static/togglebutton.js"></script>
    <script src="_static/clipboard.min.js"></script>
    <script src="_static/copybutton.js"></script>
    <script src="_static/sphinx-book-theme.js"></script>
    <script >var togglebuttonSelector = '.toggle, .admonition.dropdown, .tag_hide_input div.cell_input, .tag_hide-input div.cell_input, .tag_hide_output div.cell_output, .tag_hide-output div.cell_output, .tag_hide_cell.cell, .tag_hide-cell.cell';</script>
    <script async="async" src="https://unpkg.com/thebelab@latest/lib/index.js"></script>
    <script >
        const thebe_selector = ".thebe"
        const thebe_selector_input = "pre"
        const thebe_selector_output = ".output"
    </script>
    <script async="async" src="_static/sphinx-thebe.js"></script>
    <link rel="index" title="Index" href="genindex.html" />
    <link rel="search" title="Search" href="search.html" />
    <link rel="next" title="Chapter 6: Information about Information" href="chapter06.html" />
    <link rel="prev" title="Chapter 4: Storing Information" href="chapter04.html" />

    <meta name="viewport" content="width=device-width, initial-scale=1">
    <meta name="docsearch:language" content="en">



  </head>
  <body data-spy="scroll" data-target="#bd-toc-nav" data-offset="80">
    

    <div class="container-xl">
      <div class="row">
          
<div class="col-12 col-md-3 bd-sidebar site-navigation show" id="site-navigation">
    
        <div class="navbar-brand-box">
<a class="navbar-brand text-wrap" href="index.html">
  
  <img src="_static/logo.png" class="logo" alt="logo">
  
  
  <h1 class="site-logo" id="site-title">Information Science</h1>
  
</a>
</div>

<form class="bd-search d-flex align-items-center" action="search.html" method="get">
  <i class="icon fas fa-search"></i>
  <input type="search" class="form-control" name="q" id="search-input" placeholder="Search this book..." aria-label="Search this book..." autocomplete="off" >
</form>

<nav class="bd-links" id="bd-docs-nav" aria-label="Main navigation">
  <ul class="nav sidenav_l1">
 <li class="toctree-l1">
  <a class="reference internal" href="chapter01.html">
   Chapter 1: Welcome
  </a>
 </li>
</ul>
<ul class="current nav sidenav_l1">
 <li class="toctree-l1">
  <a class="reference internal" href="chapter02.html">
   Chapter 2: Defining Information
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="chapter03.html">
   Chapter 3: Encoding Information
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="chapter04.html">
   Chapter 4: Storing Information
  </a>
 </li>
 <li class="toctree-l1 current active">
  <a class="current reference internal" href="#">
   Chapter 5: Querying Information
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="chapter06.html">
   Chapter 6: Information about Information
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="chapter07.html">
   Chapter 7: Indexing Information
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="chapter08.html">
   Chapter 8: Searching Information
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="chapter09.html">
   Chapter 9: Information Architecture
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="coursedetails.html">
   Information Science (2022-2023)
  </a>
 </li>
</ul>

</nav>

 <!-- To handle the deprecated key -->

<div class="navbar_extra_footer">
  Powered by <a href="https://jupyterbook.org">Jupyter Book</a>
</div>

</div>


          


          
<main class="col py-md-3 pl-md-4 bd-content overflow-auto" role="main">
    
    <div class="row topbar fixed-top container-xl">
    <div class="col-12 col-md-3 bd-topbar-whitespace site-navigation show">
    </div>
    <div class="col pl-2 topbar-main">
        
        <button id="navbar-toggler" class="navbar-toggler ml-0" type="button" data-toggle="collapse"
            data-toggle="tooltip" data-placement="bottom" data-target=".site-navigation" aria-controls="navbar-menu"
            aria-expanded="true" aria-label="Toggle navigation" aria-controls="site-navigation"
            title="Toggle navigation" data-toggle="tooltip" data-placement="left">
            <i class="fas fa-bars"></i>
            <i class="fas fa-arrow-left"></i>
            <i class="fas fa-arrow-up"></i>
        </button>
        
        <div class="dropdown-buttons-trigger">
    <button id="dropdown-buttons-trigger" class="btn btn-secondary topbarbtn" aria-label="Download this page"><i
            class="fas fa-download"></i></button>

    
    <div class="dropdown-buttons">
        <!-- ipynb file if we had a myst markdown file -->
        
        <!-- Download raw file -->
        <a class="dropdown-buttons" href="_sources/chapter05.ipynb"><button type="button"
                class="btn btn-secondary topbarbtn" title="Download source file" data-toggle="tooltip"
                data-placement="left">.ipynb</button></a>
        <!-- Download PDF via print -->
        <button type="button" id="download-print" class="btn btn-secondary topbarbtn" title="Print to PDF"
            onClick="window.print()" data-toggle="tooltip" data-placement="left">.pdf</button>
    </div>
    
</div>
        <!-- Source interaction buttons -->


        <!-- Full screen (wrap in <a> to have style consistency -->
        <a class="full-screen-button"><button type="button" class="btn btn-secondary topbarbtn" data-toggle="tooltip"
                data-placement="bottom" onclick="toggleFullScreen()" title="Fullscreen mode"><i
                    class="fas fa-expand"></i></button></a>

        <!-- Launch buttons -->

<div class="dropdown-buttons-trigger">
    <button id="dropdown-buttons-trigger" class="btn btn-secondary topbarbtn"
        aria-label="Launch interactive content"><i class="fas fa-rocket"></i></button>
    <div class="dropdown-buttons">
        
        <a class="binder-button" href="https://mybinder.org/v2/gh/executablebooks/jupyter-book/master?urlpath=tree/chapter05.ipynb"><button type="button"
                class="btn btn-secondary topbarbtn" title="Launch Binder" data-toggle="tooltip"
                data-placement="left"><img class="binder-button-logo"
                    src="_static/images/logo_binder.svg"
                    alt="Interact on binder">Binder</button></a>
        
        
        
        <a class="colab-button" href="https://colab.research.google.com/github/executablebooks/jupyter-book/blob/master/chapter05.ipynb"><button type="button" class="btn btn-secondary topbarbtn"
                title="Launch Colab" data-toggle="tooltip" data-placement="left"><img class="colab-button-logo"
                    src="_static/images/logo_colab.png"
                    alt="Interact on Colab">Colab</button></a>
        
        
    </div>
</div>

    </div>

    <!-- Table of contents -->
    <div class="d-none d-md-block col-md-2 bd-toc show">
        <div class="tocsection onthispage pt-5 pb-3">
            <i class="fas fa-list"></i> Contents
        </div>
        <nav id="bd-toc-nav">
            <ul class="nav section-nav flex-column">
 <li class="toc-h2 nav-item toc-entry">
  <a class="reference internal nav-link" href="#query-languages">
   Query languages
  </a>
  <ul class="nav section-nav flex-column">
   <li class="toc-h3 nav-item toc-entry">
    <a class="reference internal nav-link" href="#database-querying-sql-sqlite">
     Database querying: SQL/SQLite
    </a>
    <ul class="nav section-nav flex-column">
     <li class="toc-h4 nav-item toc-entry">
      <a class="reference internal nav-link" href="#sql-queries">
       SQL queries
      </a>
     </li>
     <li class="toc-h4 nav-item toc-entry">
      <a class="reference internal nav-link" href="#python-sqlite3">
       Python sqlite3
      </a>
     </li>
    </ul>
   </li>
   <li class="toc-h3 nav-item toc-entry">
    <a class="reference internal nav-link" href="#information-retrieval-querying-cql-sru">
     Information retrieval querying: CQL/SRU
    </a>
    <ul class="nav section-nav flex-column">
     <li class="toc-h4 nav-item toc-entry">
      <a class="reference internal nav-link" href="#sru">
       SRU
      </a>
     </li>
     <li class="toc-h4 nav-item toc-entry">
      <a class="reference internal nav-link" href="#cql">
       CQL
      </a>
     </li>
     <li class="toc-h4 nav-item toc-entry">
      <a class="reference internal nav-link" href="#example-cerl-thesaurus">
       Example: CERL thesaurus
      </a>
     </li>
    </ul>
   </li>
  </ul>
 </li>
 <li class="toc-h2 nav-item toc-entry">
  <a class="reference internal nav-link" href="#apis">
   APIs
  </a>
 </li>
 <li class="toc-h2 nav-item toc-entry">
  <a class="reference internal nav-link" href="#exercise-europeana-entities-api">
   Exercise: Europeana Entities API
  </a>
  <ul class="nav section-nav flex-column">
   <li class="toc-h3 nav-item toc-entry">
    <a class="reference internal nav-link" href="#task">
     Task
    </a>
    <ul class="nav section-nav flex-column">
     <li class="toc-h4 nav-item toc-entry">
      <a class="reference internal nav-link" href="#some-tips">
       Some tips:
      </a>
     </li>
    </ul>
   </li>
  </ul>
 </li>
</ul>

        </nav>
    </div>
</div>
    <div id="main-content" class="row">
        <div class="col-12 col-md-9 pl-md-3 pr-md-0">
        
              <div>
                
  <div class="section" id="chapter-5-querying-information">
<h1>Chapter 5: Querying Information<a class="headerlink" href="#chapter-5-querying-information" title="Permalink to this headline">¶</a></h1>
<p><img alt="" src="_images/algorithms.png" /></p>
<p>Credit: <a class="reference external" href="https://xkcd.com/1831/">xkcd</a></p>
<blockquote>
<div><p><em>TL;DR: Querying data is at the heart of information retrieval, whether we query for data or for documents that contain data.</em></p>
</div></blockquote>
<div class="section" id="query-languages">
<h2>Query languages<a class="headerlink" href="#query-languages" title="Permalink to this headline">¶</a></h2>
<p>Database operations can be summarized with the acronym <code class="docutils literal notranslate"><span class="pre">CRUD</span></code>: create, read, update and delete.</p>
<p>From an information standpoint, the main focus is <strong>reading</strong> from the database. Most often though, we do not read directly, as this is not possible (not all databases can be browsed), or practical (we get too much information). Instead, reading databases is usually done through <strong>querying</strong>, for which we use <a class="reference external" href="https://en.wikipedia.org/wiki/Query_language">query languages</a>.</p>
<p>Actually, query languages surpass databases. Formally, query languages can be classified as <strong>database query languages</strong> versus <strong>information retrieval query languages</strong>. The difference is that a database query language attempts to give factual answers to factual questions, while an information retrieval query language attempts to find documents containing information that is relevant to an area of inquiry.</p>
<p>For the former we will discuss SQL, for the latter CQL.</p>
<div class="section" id="database-querying-sql-sqlite">
<h3>Database querying: SQL/SQLite<a class="headerlink" href="#database-querying-sql-sqlite" title="Permalink to this headline">¶</a></h3>
<p>SQL is a technology that is probably new to most of you. Unlike RDF, which some libraries seem hesitant to adopt, SQL is ubiquitous, including outside of libraries. Moreover, SQL has for instance heavily influenced the aforementioned CQL, and also <a class="reference external" href="https://en.wikipedia.org/wiki/SPARQL">SPARQL</a>, the query language for RDF. So knowing SQL will open many doors.</p>
<p>SQL is the query language for RDBMS, which are most often implemented in a <em>client-server</em> database engine. So for you to use SQL you would need a connection to a SQL database <strong>server,</strong> i.e. something like <a class="reference external" href="https://en.wikipedia.org/wiki/MySQL">MySQL</a> or <a class="reference external" href="https://en.wikipedia.org/wiki/PostgreSQL">PostgreSQL</a>, which you can see, for instance, running on my local machine like so:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span>tdeneire@XPS-13-9370:~/tmp$ ps -ef | grep postgres

postgres    1258       1  0 07:01 ?        00:00:00 /usr/lib/postgresql/12/bin/postgres -D /var/lib/postgresql/12/main -c config_file=/etc/postgresql/12/main/postgresql.conf
postgres    1286    1258  0 07:01 ?        00:00:00 postgres: 12/main: checkpointer   
postgres    1287    1258  0 07:01 ?        00:00:00 postgres: 12/main: background writer   
postgres    1288    1258  0 07:01 ?        00:00:00 postgres: 12/main: walwriter   
postgres    1289    1258  0 07:01 ?        00:00:00 postgres: 12/main: autovacuum launcher   
postgres    1290    1258  0 07:01 ?        00:00:00 postgres: 12/main: stats collector   
postgres    1291    1258  0 07:01 ?        00:00:00 postgres: 12/main: logical replication launcher
</pre></div>
</div>
<p>However, there is also a very good <strong>standalone</strong> alternative, called <a class="reference external" href="https://en.wikipedia.org/wiki/SQLite">SQLite</a>.</p>
<p>Simply said SQLite is just a single file, but you can query it just like a SQL database server. Moreover, you can access SQLite databases from many programming languages (C, Python, PHP, Go, …), but you can also handle them with GUIs like <a class="reference external" href="https://sqlitebrowser.org/">DB Browser</a>, which makes them also very suitable for non-technical use.</p>
<p>If you want to know more about SQLite, I wrote this <a class="reference external" href="https://tomdeneire.medium.com/the-most-widely-used-database-in-the-world-d0cd87f7c482">blog</a> about why it is the most widely-used database in the world…</p>
<div class="section" id="sql-queries">
<h4>SQL queries<a class="headerlink" href="#sql-queries" title="Permalink to this headline">¶</a></h4>
<p>There are some minute differences between SQL syntax and the SQLite dialect, but these so small they can be neglected.</p>
<p>SQL queries always take the same basic form: we <strong>select</strong> data from a table (mandatory), <strong>where</strong> certain conditions apply (optional). We can use <strong>join</strong> (in different forms) to add one or more tables to the selected table:</p>
<p><img alt="" src="_images/sql.png" /></p>
<p>This <a class="reference external" href="https://github.com/ABZ-Aaron/CheatSheets/blob/main/SQL-V2-Light.pdf">SQL cheat sheet</a> also offers a great summary.</p>
<p>Let’s look at a concrete example.</p>
</div>
<div class="section" id="python-sqlite3">
<h4>Python sqlite3<a class="headerlink" href="#python-sqlite3" title="Permalink to this headline">¶</a></h4>
<p>Python’s standard library contains the module <a class="reference external" href="https://docs.python.org/3/library/sqlite3.html">sqlite3</a> which offers an API for a SQLite database. (We will discuss API’s in general later in this chapter).</p>
<p>For example, let’s launch some SQL queries on a SQLite database of <a class="reference external" href="https://vlaamse-erfgoedbibliotheken.be/en/dossier/short-title-catalogue-flanders-stcv/stcv">STCV</a>, which is the Short Title Catalogue Flanders, an online database with extensive bibliographical descriptions of editions printed in Flanders before 1801. This database is available as part of the <a class="reference external" href="https://www.uantwerpen.be/nl/projecten/anet/open-data/">Anet Open Data</a>. A version of it is available in this repo under <code class="docutils literal notranslate"><span class="pre">data</span></code>.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="kn">import</span> <span class="nn">os</span>
<span class="kn">import</span> <span class="nn">sqlite3</span>

<span class="c1"># To use the module, you must first create a Connection object that represents the database</span>
<span class="n">conn</span> <span class="o">=</span> <span class="n">sqlite3</span><span class="o">.</span><span class="n">connect</span><span class="p">(</span><span class="n">os</span><span class="o">.</span><span class="n">path</span><span class="o">.</span><span class="n">join</span><span class="p">(</span><span class="s1">&#39;data&#39;</span><span class="p">,</span> <span class="s1">&#39;stcv.sqlite&#39;</span><span class="p">))</span>
<span class="c1"># Once you have a Connection, you create a Cursor object</span>
<span class="n">c</span> <span class="o">=</span> <span class="n">conn</span><span class="o">.</span><span class="n">cursor</span><span class="p">()</span>
<span class="c1"># To perform SQL commands you call the Cursor object&#39;s .execute() method</span>
<span class="n">query</span> <span class="o">=</span> <span class="s2">&quot;&quot;&quot;</span>
<span class="s2">        SELECT DISTINCT </span>
<span class="s2">            author.author_zvwr, </span>
<span class="s2">            title.title_ti, </span>
<span class="s2">            impressum.impressum_ju1sv FROM author</span>
<span class="s2">        JOIN </span>
<span class="s2">            title ON author.cloi = title.cloi</span>
<span class="s2">        JOIN </span>
<span class="s2">            impressum ON title.cloi = impressum.cloi</span>
<span class="s2">        ORDER BY </span>
<span class="s2">            author.author_zvwr DESC</span>
<span class="s2">        &quot;&quot;&quot;</span>
<span class="n">c</span><span class="o">.</span><span class="n">execute</span><span class="p">(</span><span class="n">query</span><span class="p">)</span>
<span class="c1"># Call fetchall() to get a list of the matching rows</span>
<span class="n">data</span> <span class="o">=</span> <span class="p">[</span><span class="n">row</span> <span class="k">for</span> <span class="n">row</span> <span class="ow">in</span> <span class="n">c</span><span class="o">.</span><span class="n">fetchall</span><span class="p">()]</span>
<span class="c1"># Print sample of result</span>
<span class="k">for</span> <span class="n">row</span> <span class="ow">in</span> <span class="n">data</span><span class="p">[</span><span class="mi">50</span><span class="p">:</span><span class="mi">60</span><span class="p">]:</span>
    <span class="nb">print</span><span class="p">(</span><span class="n">row</span><span class="p">)</span>
<span class="c1"># Close the connection when you&#39;re done</span>
<span class="n">conn</span><span class="o">.</span><span class="n">close</span><span class="p">()</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>(&#39;Ægidius de Lallaing&#39;, &#39;Den troost der scrvpvlevse; dat is: Gheestelyck medecijn-boecksken, in-houdende vele troostelijcke remedien teghen de [...] scrupuleusheyt&#39;, &#39;1647&#39;)
(&#39;Ægidius de Coninck&#39;, &#39;Commentariorvm ac dispvtationvm in Vniuersam doctrinam D. Thomæ De sacramentis et censvris tomi dvo&#39;, &#39;1624&#39;)
(&#39;Ægidius de Coninck&#39;, &#39;Responsio ad dissertationem impvgnantem absolutionem moribundi sensibus destituti&#39;, &#39;1625&#39;)
(&#39;Ægidius de Coninck&#39;, &#39;Commentariorvm ac dispvtationvm in vniuersam doctrinam D. Thomæ de sacramentis et censvris tomi dvo&#39;, &#39;1619&#39;)
(&#39;Ægidius de Coninck&#39;, &#39;Commentariorvm ac dispvtationvm in vniuersam doctrinam D. Thomæ de sacramentis et censvris tomi dvo&#39;, &#39;1616&#39;)
(&#39;Ægidius de Coninck&#39;, &#39;De moralitate, natvra, et effectibvs actvvm svpernatvralivm in genere. Et fide, spe, ac charitate, speciatim. Libri quatuor&#39;, &#39;1623&#39;)
(&#39;Ægidius de Coninck&#39;, &#39;De actibvs svpernatvralibvs in genere&#39;, &#39;1623&#39;)
(&#39;Ægidius de Coninck&#39;, &#39;Dispvtationes theologicæ de sanctissima trinitate et divini verbi incarnatione&#39;, &#39;1645&#39;)
(&#39;Ægidius Perrinus&#39;, &#39;Sextvs decretalivm liber&#39;, &#39;1573&#39;)
(&#39;Ægidius Perrinus&#39;, &#39;Institvtionvm, sive Primorum totius iurisprudentiæ elementorum libri qvatvor&#39;, &#39;1575&#39;)
</pre></div>
</div>
</div>
</div>
<p>Becoming fully versed in SQL is beyond the scope of this course. In this context, it is enough to understand the capabilities of SQL and the basic anatomy of a SQL query. This will help you to better understand RDBM systems as a whole or learn new querying technologies, such as the aforementioned SPARQL, which is effectively a variant of SQL:</p>
<p>Consider this example:</p>
<div class="highlight-sql notranslate"><div class="highlight"><pre><span></span>SELECT DISTINCT 
    ?resource, ?name, ?birthDate, ?deathDate
WHERE {
    ?resource rdfs:label &quot;Hugo Claus&quot;@en; 
              rdfs:label ?name; 
              rdf:type dbo:Person
    OPTIONAL {?resource dbp:birthDate ?birthDate}.
    OPTIONAL {?resource dbp:deathDate ?deathDate}
    FILTER(?name = &quot;Hugo Claus&quot;@en)
}
</pre></div>
</div>
<p>Execute this query against the <a class="reference external" href="https://dbpedia.org/sparql?default-graph-uri=http%3A%2F%2Fdbpedia.org&amp;query=++++++++++++SELECT+DISTINCT+%0D%0A%3Fresource%2C+%3Fname%2C+%3FbirthDate%2C+%3FdeathDate%0D%0A++++++++++++WHERE+%7B%3Fresource+rdfs%3Alabel+%22Hugo+Claus%22%40en%3B+rdfs%3Alabel+%3Fname%3B+rdf%3Atype+dbo%3APerson%0D%0A++++++++++++OPTIONAL+%7B%3Fresource+dbp%3AbirthDate+%3FbirthDate%7D.%0D%0A++++++++++++OPTIONAL+%7B%3Fresource+dbp%3AdeathDate+%3FdeathDate%7D%0D%0A++++++++++++FILTER%28%3Fname+%3D+%22Hugo+Claus%22%40en%29%7D%0D%0A&amp;format=application%2Fsparql-results%2Bjson&amp;timeout=10000&amp;signal_void=on&amp;signal_unconnected=on">DBPedia SPARQL endpoint</a>.</p>
</div>
</div>
<div class="section" id="information-retrieval-querying-cql-sru">
<h3>Information retrieval querying: CQL/SRU<a class="headerlink" href="#information-retrieval-querying-cql-sru" title="Permalink to this headline">¶</a></h3>
<p>Contextual query language or <strong>CQL</strong> is an example of an information retrieval query language. According to <a class="reference external" href="https://en.wikipedia.org/wiki/Contextual_Query_Language">Wikipedia:Contextual_Query_Language</a></p>
<blockquote>
<div><p>Contextual Query Language (CQL), previously known as Common Query Language, is a formal language for representing queries to information retrieval systems such as search engines, bibliographic catalogs and museum collection information. (…) its design objective is that queries be human readable and writable, and that the language be intuitive while maintaining the expressiveness of more complex query languages. It is being developed and maintained by the Z39.50 Maintenance Agency, part of the Library of Congress.</p>
</div></blockquote>
<p>Querying with CQL operates via <strong>SRU</strong> - Search/Retrieve via URL, which is an XML-based protocol for search queries.</p>
<p>You can find the full specifications for <a class="reference external" href="https://www.loc.gov/standards/sru/cql/spec.html">CQL</a> and <a class="reference external" href="http://www.loc.gov/standards/sru/index.html">SRU</a> at the Library of Congress website, what is offered here is only the basics.</p>
<div class="section" id="sru">
<h4>SRU<a class="headerlink" href="#sru" title="Permalink to this headline">¶</a></h4>
<p>SRU (Search/Retrieve via URL) is a standard search protocol for Internet search queries. In the context of libraries, SRU is mainly used for search and retrieval of bibliographic records from the catalog.</p>
<p>A valid SRU request always contains a reference to the SRU “version” and an “operation”, optionally enriched with “parameters”.</p>
<p>The <strong>explain</strong> operation allows a client to retrieve a description of the facilities available at an SRU server. It can then be used by the client to self-configure and provide an appropriate interface to the user. The response includes list of all the searchable <strong>indexes</strong>.</p>
<p>e.g. <a class="reference external" href="https://data.cerl.org/thesaurus/_sru?version=1.2&amp;operation=explain">https://data.cerl.org/thesaurus/_sru?version=1.2&amp;operation=explain</a></p>
<p>The <strong>searchRetrieve</strong> operation is the main operation of SRU. It allows the client to submit a search and retrieve request for matching records from the server. This operation needs to be combined with the <strong>query</strong> parameter</p>
<p>e.g. <a class="reference external" href="https://data.cerl.org/thesaurus/_sru?version=1.2&amp;operation=searchRetrieve&amp;query=erasmus">https://data.cerl.org/thesaurus/_sru?version=1.2&amp;operation=searchRetrieve&amp;query=erasmus</a></p>
<p>Note the tag <code class="docutils literal notranslate"><span class="pre">&lt;srw:numberOfRecords&gt;</span></code>. Most SRU servers will not give you the entire response in one go. You can use the parameters <code class="docutils literal notranslate"><span class="pre">&amp;startRecord=</span></code> and <code class="docutils literal notranslate"><span class="pre">&amp;maximumRecords=</span></code> to harvest the whole result in chunks. For instance:</p>
<p><a class="reference external" href="http://sru.gbv.de/hpb?version=2.0&amp;operation=searchRetrieve&amp;query=lipsius">http://sru.gbv.de/hpb?version=2.0&amp;operation=searchRetrieve&amp;query=lipsius</a></p>
<p>-&gt;</p>
<p><a class="reference external" href="http://sru.gbv.de/hpb?version=2.0&amp;operation=searchRetrieve&amp;query=lipsius&amp;&amp;startRecord=1&amp;maximumRecords=10">http://sru.gbv.de/hpb?version=2.0&amp;operation=searchRetrieve&amp;query=lipsius&amp;startRecord=1&amp;maximumRecords=10</a></p>
</div>
<div class="section" id="cql">
<h4>CQL<a class="headerlink" href="#cql" title="Permalink to this headline">¶</a></h4>
<p>A SRU search statement, i.e. the <code class="docutils literal notranslate"><span class="pre">&amp;query=</span></code> part, is expressed in <a class="reference external" href="http://zing.z3950.org/cql/intro.html">CQL syntax</a>.</p>
<p>The simplest CQL queries are unqualified <strong>single terms</strong>:</p>
<p>e.g. <a class="reference external" href="https://data.cerl.org/thesaurus/_sru?version=1.2&amp;operation=searchRetrieve&amp;query=lipsius&amp;startRecord=1">https://data.cerl.org/thesaurus/_sru?version=1.2&amp;operation=searchRetrieve&amp;query=lipsius&amp;startRecord=1</a></p>
<p>Queries may be joined together using the three <strong>Boolean operators</strong>, <code class="docutils literal notranslate"><span class="pre">and</span></code>, <code class="docutils literal notranslate"><span class="pre">or</span></code> and <code class="docutils literal notranslate"><span class="pre">not</span></code>. We use spaces, or rather their URL encoded version <code class="docutils literal notranslate"><span class="pre">%20</span></code> to separate CQL words:</p>
<p>e.g. <a class="reference external" href="https://data.cerl.org/thesaurus/_sru?version=1.2&amp;operation=searchRetrieve&amp;query=lipsius%20or%20erasmus&amp;startRecord=1">https://data.cerl.org/thesaurus/_sru?version=1.2&amp;operation=searchRetrieve&amp;query=lipsius%20or%20erasmus&amp;startRecord=1</a></p>
<p>The queries discussed so far are targeted at whole records. Sometimes we need to be more specific, and limit a search to a particular field of the records we’re interested in. In CQL, we do this using <strong>indexes</strong>. An index is generally attached to its search-term with an equals sign (=). Indexes indicate what part of the records is to be searched - in implementation terms, they frequently specify which index is to be inspected in the database. For information about which specific indexes you can use, use the <code class="docutils literal notranslate"><span class="pre">explain</span></code> operation:</p>
<p>e.g. <a class="reference external" href="https://data.cerl.org/thesaurus/_sru?version=1.2&amp;operation=searchRetrieve&amp;query=ct.imprintname=moretus&amp;startRecord=1">https://data.cerl.org/thesaurus/_sru?version=1.2&amp;operation=searchRetrieve&amp;query=ct.imprintname=moretus&amp;startRecord=1</a></p>
<p>SRU also allows other <strong>relations</strong> than equality (<code class="docutils literal notranslate"><span class="pre">=</span></code>) which we have just used (e.g. <code class="docutils literal notranslate"><span class="pre">publicationYear</span> <span class="pre">&lt;</span> <span class="pre">1980</span></code>) and <strong>pattern matching</strong>:</p>
<p>e.g. <a class="reference external" href="https://data.cerl.org/thesaurus/_sru?version=1.2&amp;operation=searchRetrieve&amp;query=m*retus&amp;startRecord=1">https://data.cerl.org/thesaurus/_sru?version=1.2&amp;operation=searchRetrieve&amp;query=m*retus&amp;startRecord=1</a></p>
</div>
<div class="section" id="example-cerl-thesaurus">
<h4>Example: CERL thesaurus<a class="headerlink" href="#example-cerl-thesaurus" title="Permalink to this headline">¶</a></h4>
<p>Let’s have a more detailed look at one of the examples used frequently in the above. This source that supports SRU/CQL is the <a class="reference external" href="https://cerl.org/">CERL (Consortium of European Research Libraries)</a>, which is responsible for the <a class="reference external" href="https://data.cerl.org/thesaurus/_search">CERL Thesaurus</a>, containing forms of imprint places, imprint names, personal names and corporate names as found in material printed before the middle of the nineteenth century - including variant spellings, forms in Latin and other languages, and fictitious names.</p>
<p>Below is an example of how to query this source with SRU/CQL from Python:</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="kn">import</span> <span class="nn">urllib.parse</span>
<span class="kn">import</span> <span class="nn">urllib.request</span>
<span class="kn">import</span> <span class="nn">urllib.error</span>

<span class="n">CERL_SRU_PREFIX</span> <span class="o">=</span> <span class="s2">&quot;https://data.cerl.org/thesaurus/_sru?version=1.2&amp;operation=searchRetrieve&amp;query=&quot;</span>

<span class="k">def</span> <span class="nf">clean</span><span class="p">(</span><span class="n">string</span><span class="p">:</span> <span class="nb">str</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">str</span><span class="p">:</span>
    <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    Clean input string and URL encode</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="n">string</span> <span class="o">=</span> <span class="n">string</span><span class="o">.</span><span class="n">strip</span><span class="p">()</span>
    <span class="n">string</span> <span class="o">=</span> <span class="n">string</span><span class="o">.</span><span class="n">casefold</span><span class="p">()</span>
    <span class="n">string</span> <span class="o">=</span> <span class="n">urllib</span><span class="o">.</span><span class="n">parse</span><span class="o">.</span><span class="n">quote</span><span class="p">(</span><span class="n">string</span><span class="p">)</span>
    <span class="k">return</span> <span class="n">string</span>


<span class="k">def</span> <span class="nf">query_CERL</span><span class="p">(</span><span class="n">search</span><span class="p">:</span> <span class="nb">str</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">bytes</span><span class="p">:</span>
    <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    Query CERL thesaurus, return response or exit with errorcode</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="n">cql_query</span> <span class="o">=</span> <span class="n">clean</span><span class="p">(</span><span class="n">search</span><span class="p">)</span>
    <span class="n">url</span> <span class="o">=</span> <span class="n">CERL_SRU_PREFIX</span> <span class="o">+</span> <span class="n">cql_query</span>
    <span class="k">try</span><span class="p">:</span>
        <span class="k">with</span> <span class="n">urllib</span><span class="o">.</span><span class="n">request</span><span class="o">.</span><span class="n">urlopen</span><span class="p">(</span><span class="n">url</span><span class="p">)</span> <span class="k">as</span> <span class="n">query</span><span class="p">:</span>
            <span class="k">return</span> <span class="n">query</span><span class="o">.</span><span class="n">read</span><span class="p">()</span>
    <span class="k">except</span> <span class="n">urllib</span><span class="o">.</span><span class="n">error</span><span class="o">.</span><span class="n">HTTPError</span> <span class="k">as</span> <span class="n">HTTPerr</span><span class="p">:</span>
        <span class="n">exit</span><span class="p">(</span><span class="n">HTTPerr</span><span class="o">.</span><span class="n">code</span><span class="p">)</span>
    <span class="k">except</span> <span class="n">urllib</span><span class="o">.</span><span class="n">error</span><span class="o">.</span><span class="n">URLError</span> <span class="k">as</span> <span class="n">URLerr</span><span class="p">:</span>
        <span class="n">exit</span><span class="p">(</span><span class="nb">str</span><span class="p">(</span><span class="n">URLerr</span><span class="p">))</span>

<span class="n">user_input</span> <span class="o">=</span> <span class="nb">input</span><span class="p">()</span>
<span class="nb">print</span><span class="p">(</span><span class="nb">str</span><span class="p">(</span><span class="n">query_CERL</span><span class="p">(</span><span class="n">user_input</span><span class="p">)[</span><span class="mi">0</span><span class="p">:</span><span class="mi">1000</span><span class="p">])</span> <span class="o">+</span> <span class="s2">&quot;...&quot;</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>b&#39;&lt;?xml version=&quot;1.0&quot;?&gt;\r\n&lt;srw:searchRetrieveResponse xmlns:srw=&quot;http://www.loc.gov/zing/srw/&quot; xmlns:diag=&quot;http://www.loc.gov/zing/srw/diagnostic/&quot;&gt;\r\n&lt;srw:version&gt;1.2&lt;/srw:version&gt;\r\n&lt;srw:numberOfRecords&gt;51&lt;/srw:numberOfRecords&gt;\r\n&lt;srw:records&gt;\r\n\r\n    &lt;srw:record&gt;\r\n        &lt;srw:recordSchema&gt;http://sru.cerl.org/schema/ctas/1.1/&lt;/srw:recordSchema&gt;\r\n        &lt;srw:recordPacking&gt;xml&lt;/srw:recordPacking&gt;\r\n        &lt;srw:recordIdentifier&gt;cnp00605296&lt;/srw:recordIdentifier&gt;\r\n        &lt;srw:recordData&gt;\r\n        \r\n        \r\n        &lt;record id=&quot;cnp00605296&quot; type=&quot;personalName&quot; xmlns=&quot;http://sru.cerl.org/ctas/dtd/1.1&quot;&gt;&lt;info&gt;&lt;display&gt;Lipsius, Jacob&lt;/display&gt;&lt;/info&gt;&lt;nameForms&gt;&lt;headingForm name=&quot;full&quot;&gt;Jacob Lipsius&lt;/headingForm&gt;&lt;headingForm name=&quot;inverted&quot;&gt;Lipsius, Jacob&lt;/headingForm&gt;&lt;variantForm name=&quot;full&quot;&gt;Jacobus Lipsius&lt;/variantForm&gt;&lt;variantForm name=&quot;inverted&quot;&gt;Lipsius, Jacobus&lt;/variantForm&gt;&lt;variantForm name=&quot;full&quot;&gt;Jakob Lipsius&lt;/variantForm&gt;&lt;variantForm name=&quot;inverted&quot;&gt;Lipsius, Jakob&lt;/variantForm&gt;&lt;/nameForm&#39;...
</pre></div>
</div>
</div>
</div>
</div>
</div>
</div>
<div class="section" id="apis">
<h2>APIs<a class="headerlink" href="#apis" title="Permalink to this headline">¶</a></h2>
<p>An SRU server is an example of a web <a class="reference external" href="https://en.wikipedia.org/wiki/API">API</a>, or Application Programming Interface.</p>
<p>Non-technical users mostly interact with data through a GUI or Graphical User Interface, either locally (e.g. you use DBbrowser to look at an SQLite database) or on the web (e.g. you use Wikidata’s web page). However, when we try to interact with this data from a machine-standpoint, i.e. in programming, this GUI is not suitable. We need an interface that is geared towards computers. So we use a local API (e.g. Python’s <code class="docutils literal notranslate"><span class="pre">sqlite3</span></code> module) or web API (e.g. <a class="reference external" href="https://query.wikidata.org/">Wikidata’s Query Service</a>) to get this data in a way that can be easily handled by computers.</p>
<p>In this way, an API is an intermediary structure, which has a lot of benefits. Wouldn’t it be nicer to have direct access to a certain database? In a way, yes, but this would also cause problems. There are many, many different database architectures, but <a class="reference external" href="https://levelup.gitconnected.com/comparing-api-architectural-styles-soap-vs-rest-vs-graphql-vs-rpc-84a3720adefa">API architectures</a> are generally quite predictable. They are often based on well-known technologies like JSON or XML, so you don’t have to learn a new query language. Moreover, suppose Wikidata changes their database. All of your code that uses the database would need to be rewritten. By using the API intermediary structure Wikidata can change the underlying database, but make sure their API still functions in the same way as before.</p>
<p>There are lots of free web APIs out there. The <a class="reference external" href="https://api.nasa.gov/">NASA API</a>, for instance, is quite incredible. For book information there is <a class="reference external" href="https://openlibrary.org/dev/docs/api/books">OpenLibrary</a>. Or this <a class="reference external" href="https://evilinsult.com/generate_insult.php?lang=en&amp;type=json">Evil Insult Generator</a>, if you want to have some fun! You can find an extensive list of free APIs <a class="reference external" href="https://github.com/public-apis/public-apis">here</a>.</p>
</div>
<div class="section" id="exercise-europeana-entities-api">
<h2>Exercise: Europeana Entities API<a class="headerlink" href="#exercise-europeana-entities-api" title="Permalink to this headline">¶</a></h2>
<p>For this exercise you will be using the JSON data made available through the <a class="reference external" href="https://pro.europeana.eu/page/entity">Europeana Entities API</a>, which allows you to search on or retrieve information from named entities. These named entities (such as persons, topics and places) are part of the Europeana Entity Collection, a collection of entities in the context of Europeana harvested from and linked to controlled vocabularies, such as <a class="reference external" href="https://www.geonames.org/">GeoNames</a>, <a class="reference external" href="https://www.dbpedia.org/about/">DBPedia</a> and <a class="reference external" href="https://www.wikidata.org/wiki/Wikidata:Main_Page">Wikidata</a>.</p>
<p>It is advisable to read the API’s <a class="reference external" href="https://pro.europeana.eu/page/entity">documentation</a> first.</p>
<div class="section" id="task">
<h3>Task<a class="headerlink" href="#task" title="Permalink to this headline">¶</a></h3>
<p>The task is simple. Write a Python script that prompts for user input of a named entity, query the API for that entity, parse the results and print them on standard output.</p>
<div class="section" id="some-tips">
<h4>Some tips:<a class="headerlink" href="#some-tips" title="Permalink to this headline">¶</a></h4>
<ul class="simple">
<li><p>You can use the key <code class="docutils literal notranslate"><span class="pre">wskey=apidemo</span></code> for your API request.</p></li>
<li><p>A good Python library to access URLs is <code class="docutils literal notranslate"><span class="pre">urllib</span></code>, an alternative (which is not in the standard library) is <code class="docutils literal notranslate"><span class="pre">requests</span></code>.</p></li>
<li><p>Think about what we have seen already about standardizing/normalizing search strings, but take this to the next level.</p></li>
<li><p>Try to anticipate what can go wrong so the program doesn’t crash in unexpected situations.</p></li>
<li><p>Test your application with the following search strings: <code class="docutils literal notranslate"><span class="pre">Erasmus</span></code>, <code class="docutils literal notranslate"><span class="pre">Justus</span> <span class="pre">Lipsius</span></code> and <code class="docutils literal notranslate"><span class="pre">Django</span> <span class="pre">Spirelli</span></code>.</p></li>
</ul>
</div>
</div>
</div>
</div>

    <script type="text/x-thebe-config">
    {
        requestKernel: true,
        binderOptions: {
            repo: "binder-examples/jupyter-stacks-datascience",
            ref: "master",
        },
        codeMirrorConfig: {
            theme: "abcdef",
            mode: "python"
        },
        kernelOptions: {
            kernelName: "python3",
            path: "./."
        },
        predefinedOutput: true
    }
    </script>
    <script>kernelName = 'python3'</script>

              </div>
              
        </div>
    </div>
    
    
    <div class='prev-next-bottom'>
        
    <a class='left-prev' id="prev-link" href="chapter04.html" title="previous page">Chapter 4: Storing Information</a>
    <a class='right-next' id="next-link" href="chapter06.html" title="next page">Chapter 6: Information about Information</a>

    </div>
    <footer class="footer mt-5 mt-md-0">
    <div class="container">
      <p>
        
          By Tom Deneire<br/>
        
            &copy; Copyright 2022.<br/>
      </p>
    </div>
  </footer>
</main>


      </div>
    </div>

    <script src="_static/js/index.js"></script>
    
  </body>
</html>